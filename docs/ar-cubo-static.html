<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>AR do Cubo (GLB estático, sample real)</title>
  <style>
    html,body { height:100%; margin:0; font-family:system-ui, Segoe UI, Roboto, Arial; background:#fff; }
    header { padding:12px 16px; border-bottom:1px solid #eee; display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
    header h1 { font-size:16px; margin:0; font-weight:700; }
    #wrap { display:grid; grid-template-rows:auto 1fr auto; height:calc(100% - 56px); }
    model-viewer { width:100%; height:100%; --poster-color:#fff; }
    footer { text-align:center; font-size:12px; color:#666; padding:8px 0; border-top:1px solid #eee; }
    #log { white-space:pre-wrap; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size:12px; padding:8px; border-top:1px solid #eee; color:#333; background:#fafafa; }
    .cta { font-weight:700; }
  </style>
  <!-- model-viewer (stable) -->
  <script type="module" src="https://cdn.jsdelivr.net/npm/@google/model-viewer@4.0.0/dist/model-viewer.min.js"></script>
</head>
<body>
  <header>
    <h1>AR do Cubo (GLB estático)</h1>
    <span id="status">Carregando…</span>
  </header>

  <div id="wrap">
    <model-viewer id="mv"
      src="https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF-Binary/Box.glb"
      alt="Cubo de amostra (Khronos glTF Sample Models)"
      ar ar-modes="webxr scene-viewer"
      camera-controls
      auto-rotate
      shadow-intensity="0.6"
      exposure="1.0">
      <button slot="ar-button" class="cta">Ver em AR</button>
    </model-viewer>
    <div id="log"></div>
    <footer>Modelo: glTF Sample Models – Box.glb (Khronos). HTTPS obrigatório para AR.</footer>
  </div>

  <script type="module">
    const logEl = document.getElementById('log');
    const statusEl = document.getElementById('status');
    const mv = document.getElementById('mv');

    function log(...args){
      console.log(...args);
      try { logEl.textContent += args.map(a => (typeof a==='object'? JSON.stringify(a) : String(a))).join(' ') + "\\n"; } catch(e){}
    }

    log('UA:', navigator.userAgent);

    // Eventos úteis
    mv.addEventListener('load', () => { log('model-viewer: load (modelo carregado).'); statusEl.textContent='Pronto.'; });
    mv.addEventListener('poster-dismissed', () => log('poster-dismissed'));
    mv.addEventListener('ar-status', (e) => log('ar-status:', e.detail.status));
    mv.addEventListener('error', (e) => { log('error:', e.message || JSON.stringify(e)); statusEl.textContent='Erro ao carregar modelo.'; });

    // Teste de fetch rápido (para diagnosticar CORS/rede)
    (async () => {
      const url = mv.getAttribute('src');
      log('Testando fetch do GLB:', url);
      try {
        const head = await fetch(url, { method:'HEAD' });
        log('HEAD status:', head.status, head.statusText);
        const len = head.headers.get('content-length');
        log('content-length:', len);
      } catch (err) {
        log('Falha no HEAD:', String(err));
      }
    })();
  </script>
</body>
</html>
